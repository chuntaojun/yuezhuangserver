<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yueserver.database.dao.ProductMapper">
    <resultMap id="ProductResult" type="com.yueserver.enity.Product">
        <id column="PrdNo" property="prdno" jdbcType="INTEGER" />
        <result column="PrdName" property="prdname" jdbcType="VARCHAR" />
        <result column="PrdCode" property="prdcode" jdbcType="INTEGER" />
        <result column="PrdIntro" property="prdintro" jdbcType="VARCHAR" />
        <result column="PrdPrice" property="prdprice" jdbcType="DOUBLE" />
        <result column="PrdCapacity" property="prdcapacity" jdbcType="DOUBLE" />
        <result column="PrdTypeNo" property="prdtypeno" jdbcType="INTEGER" />
        <result column="BrdNo" property="brdno" jdbcType="INTEGER" />
        <collection property="prdPics" ofType="com.yueserver.enity.PrdPic">
            <!--<id column="PrdPicNo" property="prdpicno" />-->
            <result column="PrdPicUrl" property="prdpicurl" />
        </collection>
    </resultMap>

    <select id="queryProductInfo" resultMap="ProductResult">
        SELECT * FROM Product p, PrdPic pic WHERE p.PrdNo=pic.PrdNo;
    </select>

    <select id="queryMerchantPrd" resultMap="ProductResult" parameterType="java.lang.Integer">
        SELECT * FROM Product p, Brand b, PrdPic pic WHERE p.BrdNo=b.BrdNo AND p.PrdNo=pic.PrdNo AND b.MctNo=#{mctNo}
    </select>

    <select id="queryPrdName" resultType="com.yueserver.enity.Product">
        SELECT PrdName FROM Product, Manage WHERE Product.BrdNo=Manage.BrdNo AND Manage.MctNo=#{mctNo}
    </select>

    <insert id="saveBatchPrd" keyColumn="PrdNo" useGeneratedKeys="true" parameterType="java.util.List">
        INSERT INTO Product
            (PrdName, PrdCode, PrdIntro, PrdPrice, PrdCapacity, PrdTypeNo, BrdNo)
        VALUES
            (#{PrdName}, #{PrdCode}, #{PrdIntro}, #{PrdPrice}, #{PrdCapacity}, #{PrdTypeNo}, #{BrdNo})
    </insert>

    <update id="updatePrdInfo" keyColumn="PrdNo" useGeneratedKeys="true">
        UPDATE
            Product
        SET
        <if test="PrdName != null">
            Product.PrdName = #{PrdName},
        </if>
        <if test="PrdCode != null">
            Product.PrdCode = #{PrdCode},
        </if>
        <if test="PrdIntro != null">
            Product.PrdIntro = #{PrdIntro},
        </if>
        <if test="PrdPrice != null">
            Product.PrdPrice = #{PrdPrice},
        </if>
        <if test="PrdCapacity != null">
            Product.PrdCapacity = #{PrdCapacity}
        </if>
        WHERE
            PrdNo = #{PrdNo}
    </update>

    <delete id="deleBatchPrd">
        DELETE FROM
            Product
        WHERE
        <foreach collection="set" item="item" separator="OR">
            PrdNo=#{item}
        </foreach>
    </delete>

</mapper>